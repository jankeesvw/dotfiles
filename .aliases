#### Git aliases ####
alias railsc="spring rails c"
alias gac="git add .;git commit -a -v"  #git add and commit
alias gl="git log --pretty=format:'%h - %an, %ar: %s'" # show a nice log: 'Jankees van Woezik, 3 days ago : Log meisters readme file'
alias gs="git status"
alias mate="subl"
alias gm="git checkout master"
alias gx="gitup open"
alias gb="git branch -av"
alias gnb="git checkout -b "
alias glog="git log --format='%Cgreen%h%Creset %C(cyan)%an%Creset - %s' --graph"
alias gp="git pull -r"
alias gc="git checkout"
alias semver="git semver-tags"
alias prune_branches='git checkout master && git fetch && git remote prune origin && git branch --merged master | grep -v "master$" | xargs git branch -d'
alias push="git push && github browse"
alias bam="git push && github browse"
alias route="rake routes | grep"
alias gtrack='git branch -u origin/$(current_branch)'
alias new_hashes="perl -pi -e 's/:([\w\d_]+)(\s*)=>/\1:/g'"
alias ip="ifconfig | grep 'inet' | grep -oE \"\w+ [0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\""
alias rebase="git fetch; git rebase origin/master"
alias ym='ruby /Users/jankeesvw/Documents/code/ymcli/ymcli.rb'


function grill() {
  ps aux | grep -v grep | grep $1
  PROCESSES=($(ps aux | grep -v grep | grep $1 | awk '{print $2}'))
  for p in $PROCESSES
  do
    ERROR=$((kill -9 $p) 2>&1)
    if [[ $ERROR == *"operation not permitted"* ]]; then
      read "retry?Killing $p not permitted, retry with sudo? "
      if [[ "$retry" =~ ^[Yy]$ ]]
      then
        ERROR=$((sudo kill -9 $p) 2>&1)
      else
        echo "Grill not permitted"
        return false
      fi
    fi

    if [[ ! "$ERROR" == *"no such process"* ]]; then
      echo $ERROR
      return false
    fi
  done
}

function r() {
  if ls tmp/restart.txt &> /dev/null; then
    echo "Touching 'tmp/restart.txt' for Pow restart"
    touch tmp/restart.txt
  else
    echo "'tmp/restart.txt' not found. Hint: create by hand first"
  fi
}

#### System  specific aliases ####
alias l="ls -alG"
alias aliases="vim ~/dotfiles/.aliases && source ~/.zshrc"
alias finderS='defaults write com.apple.finder AppleShowAllFiles TRUE && killall Finder'
alias finderH='defaults write com.apple.finder AppleShowAllFiles FALSE && killall Finder'
alias migrate="rake db:migrate && RAILS_ENV=test rake db:migrate"
alias s="rails server"
alias erd="erd; rake erd; open erd.pdf"
alias belp="bundle exec localeapp pull"
alias pull="git pull -r"
alias spec="rspec spec"
alias bi="bundle install"
alias db_reset='rake db:drop db:create && rake db:schema:load db:seed db:test:clone'
alias apache_log='tail -f /private/var/log/apache2/error_log'
alias integration="bundle exec rspec spec --format nested -t integration"
alias reload="source ~/.zshrc"
alias tmux="TERM=screen-256color-bce tmux"

unsetopt correct_all

export DISABLE_COVERAGE=true

